---
phase: 04-end-to-end-quality-gates
plan: 02
type: execute
wave: 2
depends_on:
  - "04-01"
files_modified:
  - tools/nemesis-ctl.sh
  - tools/tests/test_nemesis_ctl_profiles.sh
  - projects/frontend/package.json
  - projects/frontend/vitest.config.js
  - projects/frontend/src/test/setup.js
  - projects/frontend/src/__tests__/app_navigation_smoke.test.jsx
  - projects/frontend/src/__tests__/result_view_smoke.test.jsx
  - .github/workflows/ci-fast.yml
files-modified: [tools/nemesis-ctl.sh, tools/tests/test_nemesis_ctl_profiles.sh, projects/frontend/package.json, projects/frontend/vitest.config.js, projects/frontend/src/test/setup.js, projects/frontend/src/__tests__/app_navigation_smoke.test.jsx, projects/frontend/src/__tests__/result_view_smoke.test.jsx, .github/workflows/ci-fast.yml]
autonomous: true
objective: "Add profile-aware smoke checks and frontend critical-path smoke coverage, then wire both into CI fast gate for routine pull-request enforcement."
requirements:
  - TEST-02
  - TEST-03
user_setup: []
must_haves:
  truths:
    - "Automated profile-aware smoke checks validate base/monitoring/llm readiness behavior contracts in tooling logic."
    - "Frontend critical navigation and result-view workflows are protected by automated smoke tests in CI."
  artifacts:
    - path: "tools/tests/test_nemesis_ctl_profiles.sh"
      provides: "profile smoke contract checks for nemesis-ctl readiness behavior"
      min_lines: 70
    - path: "projects/frontend/src/__tests__/app_navigation_smoke.test.jsx"
      provides: "critical dashboard/navigation smoke assertions"
    - path: "projects/frontend/src/__tests__/result_view_smoke.test.jsx"
      provides: "result-view/file-details smoke assertions"
    - path: ".github/workflows/ci-fast.yml"
      provides: "frontend and profile smoke gates in PR workflow"
  key_links:
    - from: "tools/tests/test_nemesis_ctl_profiles.sh"
      to: "tools/nemesis-ctl.sh"
      via: "shell contract tests validate profile-specific readiness matrix behavior"
    - from: "projects/frontend/src/__tests__/app_navigation_smoke.test.jsx"
      to: "projects/frontend/src/App.jsx"
      via: "router/navigation smoke coverage for critical UI entry points"
    - from: "projects/frontend/package.json"
      to: ".github/workflows/ci-fast.yml"
      via: "CI executes frontend smoke command via npm scripts"
---

<objective>
Add profile-aware smoke checks and frontend critical-path smoke coverage, then wire both into CI fast gate for routine pull-request enforcement.

Purpose: satisfy TEST-02 and TEST-03 with stable, repeatable smoke coverage across startup profile behavior and primary operator UI flows.
Output: profile smoke test script, frontend smoke harness/tests, and CI integration.
</objective>

<execution_context>
@/Users/maleick/.codex/get-shit-done/workflows/execute-plan.md
@/Users/maleick/.codex/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/REQUIREMENTS.md
@.planning/STATE.md
@.planning/phases/04-end-to-end-quality-gates/04-RESEARCH.md
@.planning/phases/04-end-to-end-quality-gates/04-01-PLAN.md
@tools/nemesis-ctl.sh
@.github/workflows/ci-fast.yml
@projects/frontend/package.json
@projects/frontend/src/App.jsx
@projects/frontend/src/components/FileViewer/FileViewer.jsx
</context>

<tasks>

## Task 1
<task type="auto">
  <name>Task 1: Add profile-aware readiness smoke contracts for nemesis-ctl</name>
  <files>tools/nemesis-ctl.sh, tools/tests/test_nemesis_ctl_profiles.sh</files>
  <action>Create shell-based smoke tests that validate profile behavior contracts (`base`, `monitoring`, `llm`) for status/readiness matrix logic without requiring real Docker services. Refactor script internals only as needed to make behavior testable and deterministic.</action>
  <verify>bash tools/tests/test_nemesis_ctl_profiles.sh</verify>
  <done>Profile-aware readiness behavior is regression-protected in automation.</done>
</task>

## Task 2
<task type="auto">
  <name>Task 2: Introduce frontend smoke harness and critical navigation/result-view tests</name>
  <files>projects/frontend/package.json, projects/frontend/vitest.config.js, projects/frontend/src/test/setup.js, projects/frontend/src/__tests__/app_navigation_smoke.test.jsx, projects/frontend/src/__tests__/result_view_smoke.test.jsx</files>
  <action>Add a lightweight frontend smoke harness (Vitest + jsdom) and implement critical-path smoke tests for app navigation and result-view/file-details rendering using mocked network/GraphQL dependencies.</action>
  <verify>cd projects/frontend && npm run test:smoke && npm run build</verify>
  <done>Critical UI navigation/result-view regressions are caught automatically.</done>
</task>

## Task 3
<task type="auto">
  <name>Task 3: Integrate profile and frontend smoke checks into CI fast gate</name>
  <files>.github/workflows/ci-fast.yml</files>
  <action>Update the PR fast-gate workflow to run profile smoke tests and frontend smoke/build steps with deterministic dependency install/setup sequencing.</action>
  <verify>rg -n "test_nemesis_ctl_profiles|test:smoke|frontend smoke|npm run build" .github/workflows/ci-fast.yml</verify>
  <done>PR CI enforces both profile-aware and frontend critical-path smoke checks.</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `bash tools/tests/test_nemesis_ctl_profiles.sh` passes
- [ ] `cd projects/frontend && npm run test:smoke && npm run build` passes
- [ ] `.github/workflows/ci-fast.yml` includes profile smoke and frontend smoke steps
- [ ] Existing CI fast checks remain intact (unit tests, readiness contract, typecheck)
</verification>

<success_criteria>

- TEST-02 and TEST-03 are enforced by automated smoke gates
- Frontend critical operator workflows are covered by deterministic tests
- Profile readiness behavior changes are caught before merge

</success_criteria>

<output>
After completion, create `.planning/phases/04-end-to-end-quality-gates/04-02-SUMMARY.md`
</output>
