---
phase: 01-service-health-contracts
plan: 02
type: execute
wave: 2
depends_on:
  - "01-01"
files_modified:
  - projects/web_api/web_api/main.py
  - projects/file_enrichment/file_enrichment/controller.py
  - projects/document_conversion/document_conversion/main.py
  - projects/alerting/alerting/main.py
  - projects/agents/agents/main.py
files-modified: [projects/web_api/web_api/main.py, projects/file_enrichment/file_enrichment/controller.py, projects/document_conversion/document_conversion/main.py, projects/alerting/alerting/main.py, projects/agents/agents/main.py]
autonomous: true
objective: "Adopt the shared readiness contract in core Python services so health endpoints report consistent dependency-aware status across profiles."
requirements:
  - RELI-01
  - RELI-02
user_setup: []
must_haves:
  truths:
    - "Core services expose consistent readiness semantics"
    - "Profile-specific readiness failures are clearly surfaced"
  artifacts:
    - path: "projects/web_api/web_api/main.py"
      provides: "contract-aligned health endpoint behavior"
    - path: "projects/file_enrichment/file_enrichment/controller.py"
      provides: "contract-aligned readiness checks"
    - path: "projects/agents/agents/main.py"
      provides: "llm profile readiness behavior"
  key_links:
    - from: "projects/web_api/web_api/main.py"
      to: "libs/common/common/health_contract.py"
      via: "shared readiness contract usage"
---

<objective>
Adopt the shared readiness contract in core Python services so health endpoints report consistent dependency-aware status across profiles.

Purpose: remove service-specific ambiguity in health reporting and make profile failures immediately diagnosable.
Output: updated health endpoint/lifespan readiness behavior in core services.
</objective>

<execution_context>
@/Users/maleick/.codex/get-shit-done/workflows/execute-plan.md
@/Users/maleick/.codex/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/REQUIREMENTS.md
@.planning/phases/01-service-health-contracts/01-CONTEXT.md
@.planning/phases/01-service-health-contracts/01-RESEARCH.md
@.planning/phases/01-service-health-contracts/01-01-SUMMARY.md
</context>

<tasks>

## Task 1
<task type="auto">
  <name>Task 1: Update service health endpoints to contract schema</name>
  <files>projects/web_api/web_api/main.py, projects/file_enrichment/file_enrichment/controller.py, projects/document_conversion/document_conversion/main.py</files>
  <action>Refactor health endpoints to return contract-aligned readiness payloads while preserving backward-compatible status fields used by existing tooling.</action>
  <verify>uv run pytest projects/web_api/tests -q</verify>
  <done>Core processing services emit consistent readiness responses</done>
</task>

## Task 2
<task type="auto">
  <name>Task 2: Normalize alerting and agents readiness behavior</name>
  <files>projects/alerting/alerting/main.py, projects/agents/agents/main.py</files>
  <action>Align alerting/agents health behavior to the shared contract, including llm-profile dependency checks and remediation hints for auth/provider failures.</action>
  <verify>uv run pytest projects/agents/tests -q</verify>
  <done>Alerting and agents health reporting is consistent with core services</done>
</task>

## Task 3
<task type="auto">
  <name>Task 3: Add profile-aware readiness regression tests</name>
  <files>projects/web_api/tests/test_llm_auth_status.py, projects/agents/tests/test_chatbot_preflight.py</files>
  <action>Add/extend tests to validate degraded/unhealthy reporting paths for dependency and auth-mode failures.</action>
  <verify>uv run pytest projects/web_api/tests/test_llm_auth_status.py projects/agents/tests/test_chatbot_preflight.py -q</verify>
  <done>Regression tests cover profile-specific readiness edge cases</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] Core service tests pass for modified health paths
- [ ] Agents/auth readiness tests pass in CI-compatible environment
- [ ] Health responses remain backward compatible for existing consumers
</verification>

<success_criteria>

- Health endpoints across core services follow the same readiness semantics
- Profile-specific dependency issues surface immediately and clearly
- Test coverage protects critical readiness behavior from regressions

</success_criteria>

<output>
After completion, create `.planning/phases/01-service-health-contracts/01-02-SUMMARY.md`
</output>
